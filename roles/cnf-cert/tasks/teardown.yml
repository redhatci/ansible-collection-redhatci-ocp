---
# Only remove the local tnf image if it has already been created (tnf_image would exist)
- name: Remove the local tnf image
  block:
    - name: Gather tnf image info
      containers.podman.podman_image_info:
        name: "{{ tnf_image }}"
      register: tnf_image_info

    - name: Remove tnf image
      containers.podman.podman_image:
        name: "{{ tnf_image }}"
        state: absent
      when: tnf_image_info.images|length
  when: tnf_image is defined

- name: Removing PodSecurity-related labels in default namespace
  community.kubernetes.k8s:
    definition:
      apiVersion: v1
      kind: Namespace
      metadata:
        name: default
        labels:
          pod-security.kubernetes.io/enforce: null
          pod-security.kubernetes.io/enforce-version: null
  when: ocp_version is version("4.12", ">=")
...
